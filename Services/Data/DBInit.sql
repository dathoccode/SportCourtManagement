CREATE DATABASE QuanLySanTheThao

use QuanLySanTheThao

CREATE TABLE tSport(
    SportID NVARCHAR(10) NOT NULL PRIMARY KEY,
    SportName NVARCHAR(50) NOT NULL
);

CREATE TABLE tCourt(
    CourtID NVARCHAR(10) NOT NULL PRIMARY KEY,
    CourtName NVARCHAR(50) NOT NULL,
    CourtAddress NVARCHAR(100) NOT NULL,
    Contact NVARCHAR(11) NULL,
    SportID NVARCHAR(10) NOT NULL,
    OpenTime TIME NOT NULL,
    CloseTime TIME NOT NULL,
	Latitude float null,
	Longtitude float null,
    Img NVARCHAR(200) NULL,
    Rating FLOAT NULL,
    FOREIGN KEY (SportID) REFERENCES tSport(SportID)
);

CREATE TABLE tSlot(
    SlotID NVARCHAR(10) NOT NULL,
    CourtID NVARCHAR(10) NOT NULL,
	SlotName NVARCHAR(20) NOT NULL,
    PRIMARY KEY (SlotID, CourtID),
    FOREIGN KEY (CourtID) REFERENCES tCourt(CourtID)
);

CREATE TABLE tPrice(
    CourtID NVARCHAR(10) NOT NULL,
    SlotID NVARCHAR(10) NOT NULL,
    StartTime TIME NOT NULL,
    EndTime TIME NOT NULL,
    UnitPrice MONEY NOT NULL,
    PRIMARY KEY (CourtID, SlotID),
    FOREIGN KEY (CourtID) REFERENCES tCourt(CourtID)
);

CREATE TABLE tRole(
    RoleID NVARCHAR(10) NOT NULL PRIMARY KEY,
    RoleName NVARCHAR(20) NOT NULL
);

CREATE TABLE tAccount(
    AccountID NVARCHAR(10) NOT NULL PRIMARY KEY,
    RoleID NVARCHAR(10) NOT NULL,
    AccName NVARCHAR(50) NOT NULL,
    AccPassword NVARCHAR(100) NOT NULL,
    AccImg IMAGE NULL,
    DateOfBirth DATE NULL,
    Gender NVARCHAR(10) NULL,
    Email NVARCHAR(100) NOT NULL UNIQUE,
    Phone NVARCHAR(15) NOT NULL,
    FOREIGN KEY (RoleID) REFERENCES tRole(RoleID)
);

CREATE TABLE tStatus(
    StatusID NVARCHAR(10) NOT NULL PRIMARY KEY,
    StatusName NVARCHAR(30) NOT NULL
);

CREATE TABLE tBooking(
    BookingID NVARCHAR(10) NOT NULL PRIMARY KEY,
    AccountID NVARCHAR(10) NOT NULL,
    BookingDate DATETIME NOT NULL,
    Sale FLOAT NULL,
    StatusID NVARCHAR(10) NOT NULL,
    Price MONEY NOT NULL,
    FOREIGN KEY (AccountID) REFERENCES tAccount(AccountID),
    FOREIGN KEY (StatusID) REFERENCES tStatus(StatusID)
);

CREATE TABLE tBookingDetail(
    DetailID NVARCHAR(10) NOT NULL PRIMARY KEY,
    BookingID NVARCHAR(10) NOT NULL,
    CourtID NVARCHAR(10) NOT NULL,
    SlotID NVARCHAR(10) NOT NULL,
    StartTime TIME NOT NULL,
    EndTime TIME NOT NULL,
    FOREIGN KEY (BookingID) REFERENCES tBooking(BookingID),
    FOREIGN KEY (CourtID) REFERENCES tCourt(CourtID),
);

CREATE TABLE tFavoriteCourt(
    CourtID NVARCHAR(10) NOT NULL,
    AccountID NVARCHAR(10) NOT NULL,
    PRIMARY KEY (CourtID, AccountID),
    FOREIGN KEY (CourtID) REFERENCES tCourt(CourtID),
    FOREIGN KEY (AccountID) REFERENCES tAccount(AccountID)
);
