@model IEnumerable<SportCourtManagement.Models.TCourt>
@{
    Layout = "_Layout";
    ViewData["Title"] = "Trang chủ";
}
<nav class="navbar top-nav fixed-top">
    <div class="container-fluid">

        @* Thông tin user *@
        <div class="d-flex justify-content-between w-100 mb-3">
            <div class="user-info">
                <img src="@ViewBag.UserAvatar" alt="User Avatar" class="user-avatar" />

                <div>
                    <span>@DateTime.Now.ToString("dddd, 'Ngày' dd/MM/yyyy", new System.Globalization.CultureInfo("vi-VN"))</span>
                    <strong>@(ViewBag.UserName ?? "Khách")</strong>
                </div>
            </div>

            <div class="nav-icons d-flex align-items-start">
                <img src="~/images/vietnam_flag.jpg" alt="Vietnam Flag" class="flag-icon" />
                <i class="fas fa-bell"></i>
            </div>
        </div>

        @* Thanh tìm kiếm và các nút *@
        <div class="d-flex flex-column flex-md-row align-items-md-center gap-3 w-100">

            @* Thanh tìm kiếm *@
            <div class="input-group shadow-sm search-bar w-100 w-md-auto flex-grow-1 mb-2 mb-md-0">
                <span class="input-group-text search-icon-btn"><i class="fas fa-search"></i></span>
                <input type="text" class="form-control" id="searchInput" placeholder="Tìm kiếm">
                <span class="input-group-text clear-search-btn"><i class="fas fa-times"></i></span>
            </div>

            @* Các nút *@
            <div class="d-flex justify-content-center justify-content-md-end gap-2 w-100">
                <a class="btn filter-btn flex-fill" asp-controller="Court" asp-action="Map">
                    <i class="fas fa-map-marked-alt"></i> Bản đồ
                </a>
                <a class="btn filter-btn flex-fill" asp-controller="Account" asp-action="MyBookings">
                    <i class="fas fa-list-ul"></i> Sân đã đặt
                </a>
                <button id="filter-favorites-btn" class="btn filter-btn flex-fill">
                    <i class="fas fa-heart"></i> Yêu thích
                </button>
            </div>
        </div>
    </div> 
</nav>

@* Nội dung chính chứa các thẻ sân (court card) *@
<div id="court-card-container">
    <div class="container">
        <div class="row g-3 justify-content-center justify-content-sm-start">

            @foreach (var court in Model)
            {
                @* Thẻ sân *@
                <div class="col-10 col-sm-6 col-md-4 col-lg-3 show-court-details"
                style="cursor: pointer;"
                data-court-id="@court.CourtId">
                    <div class="card court-card-grid shadow-sm">

                        @* Ảnh bìa thẻ *@
                        <img src="~/images/@(court.Img ?? "san_cau.png")" class="card-img-top" alt="Hình ảnh sân">

                        @* Thông tin sân *@
                        <div class="card-body">
                            <div class="d-flex gap-2">
                                <div>
                                        <img src="~/images/@(court.Img ?? "caulong.jpg")" alt="Avatar sân" class="court-card-avatar" />
                                </div>
                                <div class="flex-grow-1">
                                        <h6 class="card-title">@court.CourtName</h6>
                                        <p class="card-text"><i class="fas fa-map-marker-alt"></i> @court.CourtAddress</p>
                                        <p class="card-text"><i class="far fa-clock"></i> @court.OpenTime?.ToString(@"HH\:mm") - @court.CloseTime?.ToString(@"HH\:mm")</p>
                                </div>
                            </div>

                            @* Nút đặt sân *@
                            <a asp-controller="Booking" asp-action="Create" asp-route-courtId="@court.CourtId" class="btn btn-success btn-sm w-100 mt-2">Đặt sân</a>
                        </div>

                        @* Các nút hỗ trợ *@
                        <div class="card-icons-top">
                            <button class="icon-btn-sm fav-btn">
                                <i class="far fa-heart"></i>
                                <i class="fas fa-heart" style="display:none;"></i>
                            </button>
                            <button class="icon-btn-sm dir-btn">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>
@* Modal hiển thị thông tin chi tiết sân khi click vào thẻ sân *@
<div class="modal fade" id="courtInfoModal" tabindex="-1" aria-labelledby="courtInfoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="courtInfoModalLabel">Thông tin sân</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center">
                    <div class="spinner-border text-success" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p>Đang tải...</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                <a href="#" id="modalBookButton" class="btn btn-success disabled">Đặt sân này</a>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <link rel="stylesheet" href="~/css/Home/Home.css" asp-append-version="true" />
}
@section Scripts {
    <script src="~/js/Home/Home.js" asp-append-version="true"></script>
}